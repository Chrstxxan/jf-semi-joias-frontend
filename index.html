<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JF Semi Joias</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ================================
       BARRA DE CATEGORIAS + PESQUISA
       ================================ -->
  <nav id="faixa-categorias">
    <div class="categorias">
      <a href="#" class="categoria">Conjuntos</a>
      <a href="#" class="categoria">Pulseiras</a>
      <a href="#" class="categoria">Brincos</a>
    </div>

    <div class="busca">
      <input type="text" placeholder="Digite aqui o que procura..." />
      <button id="botao-buscar" title="Buscar">
        <img src="icons/search.svg" alt="Buscar" width="20" />
      </button>
    </div>
  </nav>

  <!-- ================================
       CABEÇALHO
       ================================ -->
  <header>
    <h1>✨JF Semi Joias✨</h1>
    <p>As melhores semi joias para você!</p>

    <div class="garantia-top">
    <span class="emoji">💎</span>
    <span>Garantia de <b>1 ano</b> em todos os produtos exceto folheados. Folheados: <b>6 meses</b>.</span>
  </div>

    <!-- Botão fixo de carrinho -->
    <button id="botao-carrinho" onclick="irParaCarrinho()" title="Carrinho">
      <img src="icons/cart.svg" alt="Carrinho" />
      <span id="contador-carrinho">0</span>
    </button>
  </header>

  <!-- ================================
       BOLHAS LATERAIS FIXAS
       ================================ -->
  <div id="bolhas-menu">
    <button class="bolha" id="botao-login" title="Entrar / Conta">
      <img src="icons/user.svg" alt="Login" />
    </button>

    <button class="bolha" id="botao-pedidos" title="Meus pedidos">
      <img src="icons/box.svg" alt="Pedidos" />
    </button>

    <button class="bolha" id="botao-favoritos" title="Favoritos">
      <img src="icons/star.svg" alt="Favoritos" />
    </button>
  </div>

  <!-- ================================
       SEÇÃO DE PRODUTOS
       ================================ -->
  <section id="produtos">
    <h2>Nossas Joias</h2>
    <div class="produtos-container">
      <p>Carregando produtos...</p>
    </div>
  </section>

  <!-- ================================
       RODAPÉ
       ================================ -->
  <footer>
    <p>© 2025 JF Semi Joias - Todos os direitos reservados</p>
  </footer>

  <!-- ================================
       SCRIPTS
       ================================ -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="script.js"></script>

  <!-- ================================
       ALERTA AUTOMÁTICO DE PAGAMENTO
       ================================ -->
  <script>
  // 🔎 Detecta o status do pagamento vindo do Mercado Pago
  const params = new URLSearchParams(window.location.search);
  const status = params.get("pagamento");

  if (status) {
    const mensagens = {
      success: {
        icon: "success",
        title: "Pagamento aprovado!",
        text: "Seu pedido foi confirmado com sucesso 🎉",
        acao: () => {
          // Limpa dados locais
          localStorage.removeItem("carrinho");
          localStorage.removeItem("pedidoAtual");

          // Atualiza contador de carrinho (caso ainda esteja no DOM)
          const contador = document.getElementById("contador-carrinho");
          if (contador) contador.textContent = "0";
        },
      },
      failure: {
        icon: "error",
        title: "Falha no pagamento",
        text: "Ocorreu um erro no processamento do pagamento. Tente novamente.",
      },
      pending: {
        icon: "info",
        title: "Pagamento em análise",
        text: "Estamos aguardando a confirmação do seu pagamento ⏳",
      },
    };

    const msg = mensagens[status];

    if (msg) {
      // Exibe o alerta visual
      Swal.fire({
        icon: msg.icon,
        title: msg.title,
        text: msg.text,
        confirmButtonColor: "#ff6fa7",
        background: "#fffafc",
        color: "#333",
      }).then(() => {
        // Executa a ação (se existir)
        msg.acao?.();

        // Limpa o parâmetro da URL para não repetir alerta ao recarregar
        window.history.replaceState({}, document.title, window.location.pathname);
      });
    }
  }

  // 💡 Extra: garante que, se o usuário voltar pro site via cache, os parâmetros "pagamento" não fiquem travados
  window.addEventListener("pageshow", (event) => {
    if (event.persisted) {
      const cleanURL = window.location.pathname;
      window.history.replaceState({}, document.title, cleanURL);
    }
  });
</script>
</body>
</html>
